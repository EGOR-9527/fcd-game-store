{"ast":null,"code":"import { makeAutoObservable } from 'mobx';\n// Ensure this is a .ts file\nimport axios from 'axios';\nconst API_URL = 'http://localhost:7000/api/';\nclass RestApi {\n  constructor() {\n    this.error = null;\n    this.user = null;\n    makeAutoObservable(this);\n  }\n  setError(error) {\n    this.error = error;\n  }\n  clearError() {\n    this.setError(null);\n  }\n  setUser(user) {\n    this.user = user;\n  }\n  async register(email, password, type, nick, nameCompany) {\n    try {\n      const response = await axios.post(`${API_URL}${type}/registration`, {\n        email,\n        password,\n        nick,\n        nameCompany\n      });\n      this.setUser(response.data);\n      this.clearError();\n    } catch (err) {\n      this.handleError(err);\n    }\n  }\n  async login(email, password, type) {\n    try {\n      const response = await axios.post(`${API_URL}${type}/login`, {\n        email,\n        password\n      });\n      this.setUser(response.data);\n      this.clearError();\n    } catch (err) {\n      this.handleError(err);\n    }\n  }\n  async addProduct(img, vendorId, name, description, keygame, price) {\n    try {\n      console.log(img, vendorId, name, description, keygame, price);\n      const response = await axios.post(`${API_URL}vendor/addProduct`, {\n        img,\n        vendorId,\n        name,\n        description,\n        keygame,\n        price\n      });\n      return response.data;\n    } catch (err) {\n      this.handleError(err);\n    }\n  }\n  async refresh() {\n    try {\n      const response = await axios.get(`${API_URL}refresh`, {\n        withCredentials: true\n      });\n      this.setUser(response.data);\n      this.clearError();\n    } catch (error) {\n      this.handleError(error);\n    }\n  }\n  handleError(error) {\n    if (axios.isAxiosError(error)) {\n      var _error$response;\n      const errorResponse = (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data;\n      const message = (errorResponse === null || errorResponse === void 0 ? void 0 : errorResponse.message) || \"Неизвестная ошибка\";\n      console.log(\"message: \" + message);\n      this.setError({\n        message\n      });\n    } else {\n      this.setError({\n        message: \"Неизвестная ошибка\"\n      });\n    }\n  }\n}\nexport const api = new RestApi();","map":{"version":3,"names":["makeAutoObservable","axios","API_URL","RestApi","constructor","error","user","setError","clearError","setUser","register","email","password","type","nick","nameCompany","response","post","data","err","handleError","login","addProduct","img","vendorId","name","description","keygame","price","console","log","refresh","get","withCredentials","isAxiosError","_error$response","errorResponse","message","api"],"sources":["C:/Users/user/Desktop/FCDgameStore/client/src/shared/api.ts"],"sourcesContent":["import { makeAutoObservable } from 'mobx';\r\nimport { AuthResponse } from '../entities/AuthResponse.tsx';\r\nimport { ErrorType } from '../entities/ErrorSchema.tsx'; // Ensure this is a .ts file\r\nimport axios from 'axios';\r\n\r\nconst API_URL = 'http://localhost:7000/api/';\r\n\r\nclass RestApi {\r\n    error: ErrorType | null = null;\r\n    user: AuthResponse | null = null;\r\n\r\n    constructor() {\r\n        makeAutoObservable(this);\r\n    }\r\n\r\n    setError(error: ErrorType | null) {\r\n        this.error = error;\r\n    }\r\n\r\n    clearError() {\r\n        this.setError(null);\r\n    }\r\n\r\n    setUser (user: AuthResponse | null) {\r\n        this.user = user;\r\n    }\r\n\r\n    async register(email: string, password: string, type: 'user' | 'vendor', nick?: string, nameCompany?: string) {\r\n        try {\r\n            const response = await axios.post<AuthResponse>(`${API_URL}${type}/registration`, { email, password, nick, nameCompany });\r\n            this.setUser (response.data);\r\n            this.clearError();\r\n        } catch (err) {\r\n            this.handleError(err);\r\n        }\r\n    }\r\n\r\n    async login(email: string, password: string, type: 'user' | 'vendor') {\r\n        try {\r\n            const response = await axios.post<AuthResponse>(`${API_URL}${type}/login`, { email, password });\r\n            this.setUser (response.data);\r\n            this.clearError();\r\n        } catch (err) {\r\n            this.handleError(err);\r\n        }\r\n    }\r\n\r\n    async addProduct(img: File, vendorId: string, name: string, description: string, keygame: string, price: string) {\r\n        try {\r\n            console.log(img, vendorId, name, description, keygame, price)\r\n\r\n            const response = await axios.post<AuthResponse>(`${API_URL}vendor/addProduct`, {img, vendorId, name, description, keygame, price});\r\n              return response.data;\r\n        } catch (err) {\r\n            this.handleError(err);\r\n        }\r\n    }\r\n\r\n    async refresh() {\r\n        try {\r\n            const response = await axios.get<AuthResponse>(`${API_URL}refresh`, { withCredentials: true });\r\n            this.setUser (response.data);\r\n            this.clearError();\r\n        } catch (error) {\r\n            this.handleError(error);\r\n        }\r\n    }\r\n\r\n    private handleError(error: any): void {\r\n        if (axios.isAxiosError(error)) {\r\n            const errorResponse = error.response?.data;\r\n            const message = errorResponse?.message || \"Неизвестная ошибка\";\r\n            console.log(\"message: \" + message);\r\n            this.setError({ message });\r\n        } else {\r\n            this.setError({ message: \"Неизвестная ошибка\" });\r\n        }\r\n    }\r\n}\r\n\r\nexport const api = new RestApi();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}